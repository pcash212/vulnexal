<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#20c997" />
    <meta
      name="description"
      content="Professional web vulnerability scanner and security testing tool"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Vulnexal" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="shortcut icon" href="favicon.svg" />
    <link rel="apple-touch-icon" href="icon-192.svg" />
    <link rel="manifest" href="manifest.json" />
    <title>Vulnexal - Dashboard</title>

    <style>
      body {
        visibility: hidden;
      }
      body.loaded {
        visibility: visible;
      }
      #auth-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #1a1d29;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
      }
      .loader-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #2a2d39;
        border-top: 4px solid #20c997;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>

    <script>
      (function () {
        try {
          var session = localStorage.getItem("vulnexal_session");
          if (!session) {
            window.location.replace("index.html");
            return;
          }
          var data = JSON.parse(session);
          if (!data.uid || !data.loginTime) {
            localStorage.removeItem("vulnexal_session");
            window.location.replace("index.html");
            return;
          }
          var age = Date.now() - data.loginTime;
          if (age >= 30 * 24 * 60 * 60 * 1000) {
            localStorage.removeItem("vulnexal_session");
            window.location.replace("index.html");
            return;
          }
        } catch (e) {
          window.location.replace("index.html");
        }
      })();
    </script>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />

    <link href="style.css" rel="stylesheet" />
  </head>
  <body>
    <div id="auth-loader">
      <div class="loader-spinner"></div>
    </div>
    <div id="app">
      <div id="dashboard-page" class="page-container active">
        <header class="dashboard-header sticky-top">
          <nav class="navbar navbar-dark bg-dark px-3 px-md-4 py-2 py-md-3">
            <div class="container-fluid px-0">
              <div class="d-flex align-items-center gap-2 flex-grow-1 min-w-0">
                <i class="bi bi-shield-check text-success fs-4"></i>
                <span
                  class="navbar-brand mb-0 h6 h5-md text-success fw-bold text-truncate"
                  style="
                    font-family: 'Arial Black', sans-serif;
                    letter-spacing: 1px;
                    text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
                  "
                  >Vulnexal</span
                >
              </div>

              <div
                class="d-flex align-items-center gap-2 gap-md-3 flex-shrink-0"
              >
                <div class="d-flex align-items-center gap-2">
                  <i class="bi bi-person-circle text-light fs-6"></i>
                  <span
                    class="text-light small fw-normal text-truncate"
                    id="user-name"
                    style="max-width: 150px"
                    >User</span
                  >
                </div>

                <div class="dropdown">
                  <button
                    class="btn btn-dark border-secondary btn-sm px-2 py-1"
                    type="button"
                    id="navMenuDropdown"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    title="Menu"
                  >
                    <i class="bi bi-list fs-4"></i>
                  </button>
                  <ul
                    class="dropdown-menu dropdown-menu-end bg-dark border-success"
                    aria-labelledby="navMenuDropdown"
                    style="min-width: 250px"
                  >
                    <li>
                      <a
                        class="dropdown-item text-light"
                        href="vulnerabilities-info.html"
                      >
                        <i class="bi bi-book text-info me-2"></i>Learn About
                        Vulnerabilities
                      </a>
                    </li>
                    <li><hr class="dropdown-divider border-secondary" /></li>
                    <li>
                      <a
                        class="dropdown-item text-light"
                        href="#"
                        data-bs-toggle="modal"
                        data-bs-target="#aboutVulnexalModal"
                      >
                        <i class="bi bi-info-circle text-warning me-2"></i>About
                        Vulnexal
                      </a>
                    </li>
                    <li><hr class="dropdown-divider border-secondary" /></li>
                    <li>
                      <a
                        class="dropdown-item text-light"
                        href="#"
                        onclick="logout(); return false;"
                      >
                        <i class="bi bi-box-arrow-right text-success me-2"></i
                        >Logout
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </nav>
        </header>

        <main class="dashboard-main py-4">
          <div class="container-fluid px-4">
            <div class="mb-5 animate-fade-in">
              <h1 class="h3 fw-bold text-dark mb-1">
                <i class="bi bi-shield-exclamation text-success me-2"></i>Web
                Vulnerability Scanner
              </h1>
              <p class="text-muted">
                Scan websites for vulnerabilities and security issues
              </p>
            </div>

            <section
              class="scan-section mb-5 animate-slide-up"
              style="animation-delay: 0.1s"
            >
              <div
                class="card border-success border-2 bg-dark text-light shadow-lg"
              >
                <div class="card-body p-4">
                  <h5 class="card-title text-success mb-4">
                    <i class="bi bi-globe2 me-2"></i>Scan Website for
                    Vulnerabilities
                  </h5>
                  <div class="row g-3">
                    <div class="col-lg-8">
                      <input
                        type="url"
                        class="form-control form-control-lg bg-dark text-light border-secondary"
                        id="scan-url-input"
                        placeholder="Enter website URL (e.g., https://example.com)"
                        style="border-color: #444 !important"
                      />
                    </div>
                    <div class="col-lg-4">
                      <button
                        class="btn btn-success btn-lg w-100 fw-bold btn-hover-lift"
                        id="scan-website-btn"
                      >
                        <i class="bi bi-play-circle me-2"></i>Scan Website
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <section
              class="vulnerabilities-section mb-5 animate-slide-up"
              style="animation-delay: 0.2s"
            >
              <div
                class="card border-info border-2 bg-dark text-light shadow-lg"
              >
                <div class="card-body p-4">
                  <h5 class="card-title text-info mb-4">
                    <i class="bi bi-list-check me-2"></i>Select Vulnerabilities
                    to Scan
                  </h5>

                  <div class="d-flex flex-wrap gap-4">
                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="https-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="https-check"
                        >
                          <i class="bi bi-shield-check text-success me-2"></i
                          >HTTPS Validation
                        </label>
                      </div>
                    </div>

                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="clickjack-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="clickjack-check"
                        >
                          <i class="bi bi-cursor-fill text-warning me-2"></i
                          >Clickjacking Protection
                        </label>
                      </div>
                    </div>

                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="availability-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="availability-check"
                        >
                          <i class="bi bi-hourglass-split text-info me-2"></i
                          >Availability Check
                        </label>
                      </div>
                    </div>

                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="xss-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="xss-check"
                        >
                          <i
                            class="bi bi-exclamation-triangle-fill text-warning me-2"
                          ></i
                          >XSS Detection
                        </label>
                      </div>
                    </div>

                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="password-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="password-check"
                        >
                          <i class="bi bi-key-fill text-danger me-2"></i
                          >Password Field Check
                        </label>
                      </div>
                    </div>

                    <div
                      style="flex: 1 1 calc(33.333% - 1rem); min-width: 200px"
                    >
                      <div class="form-check d-flex align-items-center">
                        <input
                          class="form-check-input form-check-lg"
                          type="checkbox"
                          id="url-patterns-check"
                          checked
                        />
                        <label
                          class="form-check-label ms-3 fw-normal"
                          for="url-patterns-check"
                        >
                          <i class="bi bi-link-45deg text-info me-2"></i
                          >Suspicious URL patterns
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <section
              class="results-section animate-slide-up"
              style="animation-delay: 0.3s"
            >
              <h5 class="text-success mb-4">
                <i class="bi bi-graph-up me-2"></i>Latest Scan Results
              </h5>

              <div class="d-flex flex-wrap gap-4 mb-4">
                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">
                          HTTPS Validation
                        </h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check HTTPS encryption.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">XSS Detection</h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check for XSS patterns.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">Clickjacking</h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check clickjacking protection.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">
                          Password Security
                        </h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check password field security.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">
                          Server Availability
                        </h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check server availability.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">
                          Suspicious URL Patterns
                        </h6>
                        <span class="badge bg-secondary">
                          <i class="bi bi-dash-circle me-1"></i>Pending
                        </span>
                      </div>
                      <p class="text-light small mb-2">
                        Run a scan to check for suspicious URL patterns.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="flex: 1 1 calc(33.333% - 1rem); min-width: 280px">
                  <div
                    class="result-card card border-0 bg-dark text-light shadow-sm hover-card-lift"
                  >
                    <div class="card-body p-4">
                      <div
                        class="d-flex justify-content-between align-items-start mb-3"
                      >
                        <h6 class="card-title fw-bold mb-0">Overall Score</h6>
                        <span class="score-badge">--</span>
                      </div>
                      <p class="text-light small mb-0">
                        Security Rating:
                        <strong id="security-rating" class="text-secondary"
                          >Not Scanned</strong
                        >
                      </p>
                      <p id="security-summary" class="text-light small">
                        Run a scan to see your security score.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <section
              class="scan-history mt-5 animate-slide-up"
              style="animation-delay: 0.4s"
            >
              <div class="card border-0 bg-dark text-light shadow-lg">
                <div class="card-body p-4">
                  <h5 class="card-title text-success mb-4">
                    <i class="bi bi-clock-history me-2"></i>Scan History
                  </h5>
                  <div class="table-responsive scan-history-scrollable">
                    <table
                      id="scan-history-table"
                      class="table table-dark table-hover mb-0"
                    >
                      <thead>
                        <tr class="border-bottom border-secondary">
                          <th class="text-success fw-bold">Website URL</th>
                          <th class="text-success fw-bold">Scan Date</th>
                          <th class="text-success fw-bold">Status</th>
                          <th class="text-success fw-bold">Score</th>
                          <th class="text-success fw-bold">Action</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td colspan="5" class="text-center text-muted py-4">
                            <i class="bi bi-arrow-repeat spinning me-2"></i
                            >Loading scan history...
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>

    <div id="loading-overlay" class="loading-overlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <div class="loading-text">Scanning Website...</div>
        <div class="loading-subtext">
          Please wait while we analyze the security
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="aboutVulnexalModal"
      tabindex="-1"
      aria-labelledby="aboutVulnexalModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div
          class="modal-content"
          style="
            background: linear-gradient(
              135deg,
              #0f2027 0%,
              #203a43 50%,
              #2c5364 100%
            border: 2px solid #00ff88;
            border-radius: 15px;
            box-shadow: 0 0 40px rgba(0, 255, 136, 0.3);
          "
        >
          <div
            class="modal-header border-0 py-4 px-5"
            style="background: rgba(0, 255, 136, 0.05)"
          >
            <div class="d-flex align-items-center gap-3">
              <div
                style="
                  width: 50px;
                  height: 50px;
                  background: linear-gradient(135deg, #00ff88, #00cc6a);
                  border-radius: 10px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <i class="bi bi-shield-check text-dark fs-3"></i>
              </div>
              <h3
                class="modal-title fw-bold mb-0 text-light"
                id="aboutVulnexalModalLabel"
                style="
                  font-family: 'Arial Black', sans-serif;
                  letter-spacing: 2px;
                  text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
                "
              >
                VULNEXAL
              </h3>
            </div>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
              style="filter: brightness(1.5)"
            ></button>
          </div>

          <div
            class="modal-body p-5"
            style="max-height: 70vh; overflow-y: auto"
          >
            <div class="row g-4">
              <div class="col-12">
                <div
                  class="card"
                  style="
                    background: rgba(0, 255, 136, 0.08);
                    border: 1px solid rgba(0, 255, 136, 0.3);
                    border-radius: 12px;
                  "
                >
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                      <i class="bi bi-stars text-warning fs-4 me-2"></i>
                      <h5 class="mb-0 fw-bold" style="color: #00ff88">
                        Our Mission
                      </h5>
                    </div>
                    <p
                      class="text-light mb-0"
                      style="font-size: 1.05rem; line-height: 1.8"
                    >
                      Vulnexal is a modern, innovative cybersecurity brand
                      dedicated to creating tools that help secure digital
                      environments. Our flagship project, the
                      <strong style="color: #00ff88"
                        >Vulnexal Vulnerability Scanner</strong
                      >, is designed to help developers, security professionals,
                      and organizations identify and fix vulnerabilities in web
                      applications. With speed, precision, and practical
                      insights, Vulnexal empowers users to strengthen their
                      applications and improve security posture.
                    </p>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div
                  class="card h-100"
                  style="
                    background: rgba(30, 60, 114, 0.4);
                    border: 1px solid rgba(0, 255, 136, 0.2);
                    border-radius: 12px;
                  "
                >
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                      <i
                        class="bi bi-envelope-fill fs-4 me-2"
                        style="color: #00ff88"
                      ></i>
                      <h5 class="mb-0 fw-bold" style="color: #00ff88">
                        Contact Us
                      </h5>
                    </div>
                    <p class="text-light mb-3">
                      Vulnexal is open for collaborations, partnerships, and
                      professional inquiries.
                    </p>
                    <div
                      class="d-flex align-items-center gap-2 p-3"
                      style="
                        background: rgba(0, 255, 136, 0.1);
                        border-radius: 8px;
                      "
                    >
                      <i class="bi bi-envelope-at-fill text-light"></i>
                      <a
                        href="mailto:contact@vulnexal.com"
                        class="text-light fw-bold"
                        style="text-decoration: none; font-size: 1.05rem"
                      >
                        contact@vulnexal.com
                      </a>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div
                  class="card h-100"
                  style="
                    background: rgba(30, 60, 114, 0.4);
                    border: 1px solid rgba(0, 255, 136, 0.2);
                    border-radius: 12px;
                  "
                >
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                      <i
                        class="bi bi-lightning-charge-fill fs-4 me-2"
                        style="color: #ffc107"
                      ></i>
                      <h5 class="mb-0 fw-bold" style="color: #00ff88">
                        What We Do
                      </h5>
                    </div>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-2 text-light">
                        <i class="bi bi-check-circle-fill text-success me-2"></i
                        >Web Security Scanning
                      </li>
                      <li class="mb-2 text-light">
                        <i class="bi bi-check-circle-fill text-success me-2"></i
                        >Vulnerability Detection
                      </li>
                      <li class="mb-2 text-light">
                        <i class="bi bi-check-circle-fill text-success me-2"></i
                        >Security Insights
                      </li>
                      <li class="mb-0 text-light">
                        <i class="bi bi-check-circle-fill text-success me-2"></i
                        >Risk Assessment
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="col-12">
                <div
                  class="card"
                  style="
                    background: linear-gradient(
                      135deg,
                      rgba(0, 255, 136, 0.15),
                      rgba(0, 204, 106, 0.1)
                    border: 2px solid rgba(0, 255, 136, 0.4);
                    border-radius: 12px;
                  "
                >
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-4">
                      <i
                        class="bi bi-person-badge-fill fs-3 me-2"
                        style="color: #ffc107"
                      ></i>
                      <h4 class="mb-0 fw-bold" style="color: #00ff88">
                        Meet Our CEO
                      </h4>
                    </div>

                    <div class="row align-items-center g-4">
                      <div class="col-md-3 text-center">
                        <img
                          src="/developer/ceo-photo.jpg"
                          alt="Awe Paul - CEO of Vulnexal"
                          class="rounded-circle"
                          style="
                            width: 150px;
                            height: 150px;
                            object-fit: cover;
                            border: 4px solid #00ff88;
                            box-shadow: 0 0 30px rgba(0, 255, 136, 0.6);
                          "
                          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                        />
                        <div
                          class="rounded-circle bg-success d-none align-items-center justify-content-center mx-auto"
                          style="
                            width: 150px;
                            height: 150px;
                            background: linear-gradient(
                              135deg,
                              #00ff88,
                              #00cc6a
                            ) !important;
                            border: 4px solid #00ff88;
                            box-shadow: 0 0 30px rgba(0, 255, 136, 0.6);
                          "
                        >
                          <i
                            class="bi bi-person-fill text-dark"
                            style="font-size: 4rem"
                          ></i>
                        </div>
                      </div>

                      <div class="col-md-9">
                        <h4
                          class="fw-bold mb-1"
                          style="color: #ffffff; font-size: 1.8rem"
                        >
                          Awe Paul
                        </h4>
                        <p
                          class="mb-3"
                          style="
                            color: #00ff88;
                            font-size: 1.1rem;
                            font-weight: 600;
                          "
                        >
                          <i class="bi bi-award-fill me-2"></i>CEO & Founder,
                          Vulnexal
                        </p>
                        <p
                          class="text-light mb-4"
                          style="font-size: 1.05rem; line-height: 1.8"
                        >
                          <strong>Awe Paul</strong> is a cybersecurity
                          enthusiast and full-stack developer specializing in
                          application security and penetration testing. Driven
                          by curiosity, technical expertise, and a passion for
                          problem-solving, he created Vulnexal to help others
                          detect vulnerabilities, secure web applications, and
                          advance their cybersecurity skills. Under his
                          leadership, Vulnexal is committed to innovation,
                          practical solutions, and promoting safer digital
                          environments.
                        </p>

                        <div class="d-flex gap-2 flex-wrap">
                          <span
                            class="badge px-3 py-2"
                            style="
                              background: rgba(255, 255, 255, 0.1);
                              border: 1px solid #00ff88;
                              color: #00ff88;
                              font-size: 0.95rem;
                            "
                          >
                            <i class="bi bi-shield-fill-check me-1"></i
                            >Cybersecurity Expert
                          </span>
                          <span
                            class="badge px-3 py-2"
                            style="
                              background: rgba(255, 255, 255, 0.1);
                              border: 1px solid #00ff88;
                              color: #00ff88;
                              font-size: 0.95rem;
                            "
                          >
                            <i class="bi bi-code-square me-1"></i>Full-Stack
                            Developer
                          </span>
                          <span
                            class="badge px-3 py-2"
                            style="
                              background: rgba(255, 255, 255, 0.1);
                              border: 1px solid #00ff88;
                              color: #00ff88;
                              font-size: 0.95rem;
                            "
                          >
                            <i class="bi bi-bug-fill me-1"></i>Penetration
                            Testing
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="text-center mt-4 pt-3"
              style="border-top: 1px solid rgba(0, 255, 136, 0.2)"
            >
              <p
                class="text-light mb-0"
                style="font-size: 0.95rem; opacity: 0.8"
              >
                <i class="bi bi-c-circle me-1"></i>2025 Vulnexal. All rights
                reserved.
              </p>
              <p
                class="mb-0 mt-1"
                style="color: #00ff88; font-size: 0.9rem; font-style: italic"
              >
                <i class="bi bi-shield-check me-1"></i>Securing Digital
                Environments, One Scan at a Time
              </p>
            </div>
          </div>

          <div
            class="modal-footer border-0 px-5 pb-4"
            style="background: rgba(0, 255, 136, 0.05)"
          >
            <button
              type="button"
              class="btn fw-bold px-5 py-2"
              data-bs-dismiss="modal"
              style="
                background: linear-gradient(135deg, #00ff88, #00cc6a);
                color: #1e3c72;
                border: none;
                border-radius: 8px;
                font-size: 1.05rem;
              "
            >
              <i class="bi bi-x-circle me-2"></i>Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="aboutModal"
      tabindex="-1"
      aria-labelledby="aboutModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-dark text-light border-success border-2">
          <div class="modal-header border-success border-bottom-2">
            <div class="d-flex align-items-center gap-3">
              <i
                class="bi bi-info-circle-fill text-success fs-4"
                style="animation: scalePulse 2s ease-in-out infinite"
              ></i>
              <h5 class="modal-title fw-bold" id="aboutModalLabel">
                About This Website
              </h5>
            </div>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>

          <div class="modal-body p-5">
            <div class="mb-4">
              <h6 class="text-success fw-bold mb-2">
                <i class="bi bi-star-fill text-warning me-2"></i>Brand
              </h6>
              <p class="text-light mb-0">
                <strong
                  style="
                    font-family: 'Arial Black', sans-serif;
                    letter-spacing: 1px;
                    font-size: 1.2rem;
                  "
                  >Vulnexal</strong
                >
              </p>
            </div>

            <div class="mb-4">
              <h6 class="text-success fw-bold mb-2">
                <i class="bi bi-person-fill text-info me-2"></i>Developer
              </h6>
              <p class="text-light mb-0">
                <strong>Awe O. Paul</strong>
              </p>
            </div>

            <div class="mb-4">
              <h6 class="text-success fw-bold mb-2">
                <i class="bi bi-file-text-fill text-warning me-2"></i
                >Description
              </h6>
              <p class="text-light mb-0 lh-lg">
                This platform is designed to scan websites for common
                client-side vulnerabilities using pure JavaScript. It provides
                quick insights, easy visual reports, and a clean, user-friendly
                dashboard experience.
              </p>
            </div>

            <div class="mb-4">
              <h6 class="text-success fw-bold mb-3">
                <i class="bi bi-lightning-charge-fill text-info me-2"></i
                >Features
              </h6>
              <div class="row g-2">
                <div class="col-md-6">
                  <ul class="list-unstyled">
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light">DOMâ€‘Based XSS Detection</span>
                    </li>
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light"
                        >Clickjacking Protection Test</span
                      >
                    </li>
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light">Insecure Cookies Check</span>
                    </li>
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light"
                        >Unsafe LocalStorage Analysis</span
                      >
                    </li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <ul class="list-unstyled">
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light">Open Redirect Detection</span>
                    </li>
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light">Form Security Review</span>
                    </li>
                    <li class="mb-2">
                      <i class="bi bi-check-circle-fill text-success me-2"></i>
                      <span class="text-light">Suspicious URL Analysis</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="mb-4">
              <h6 class="text-success fw-bold mb-2">
                <i class="bi bi-code-slash text-info me-2"></i>Technologies
              </h6>
              <p class="text-light mb-0">
                <span class="badge bg-secondary me-2">HTML5</span>
                <span class="badge bg-secondary me-2">CSS / Bootstrap 5</span>
                <span class="badge bg-secondary">Vanilla JavaScript</span>
              </p>
            </div>

            <div
              class="alert alert-info bg-info bg-opacity-10 border-info border-2"
            >
              <div class="d-flex align-items-center">
                <i class="bi bi-tag-fill text-info me-3 fs-5"></i>
                <div>
                  <strong class="text-light">Version</strong>
                  <p class="text-light mb-0 ms-3">v1.0.0</p>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer border-success border-top-2">
            <button
              type="button"
              class="btn btn-outline-success fw-bold"
              id="closeModalBtn"
              data-bs-dismiss="modal"
            >
              <i class="bi bi-x-circle me-2"></i>Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script src="validation.js"></script>
    <script src="modal.js"></script>
    <script src="escape-helper.js"></script>
    <script src="auth-manager.js"></script>
    <script src="pwa.js"></script>
    <div id="process-loading-overlay" class="process-loading-overlay">
      <div class="process-loading-content">
        <div class="process-loading-logo">
          <i class="bi bi-shield-check"></i>
        </div>
        <div class="process-loading-text">Processing...</div>
        <div class="process-loading-subtext">Please wait</div>
      </div>
    </div>

    <script>
      function showDashboard() {
        var loader = document.getElementById('auth-loader');
        if (loader) loader.style.display = 'none';
        document.body.classList.add('loaded');
      }

      const firebaseConfig = {
        apiKey: "AIzaSyBJ3XdoHatJhGOKFcnoAYMTqPGYW3Jymk4",
        authDomain: "web-vulnerability-scanne-f066b.firebaseapp.com",
        projectId: "web-vulnerability-scanne-f066b",
        storageBucket: "web-vulnerability-scanne-f066b.appspot.com",
        messagingSenderId: "875094369190",
        appId: "1:875094369190:web:276df6ce835be8b3672567",
        measurementId: "G-HFS9XCX60H",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      auth
        .setPersistence(firebase.auth.Auth.Persistence.LOCAL)
        .then(function () {
          AuthManager.init();
        })
        .catch(function (error) {});

      const logout = function() {
        AuthManager.logout();
      };

      async function loadUserData(user) {
        const nameEl = document.getElementById("user-name");
        if (!nameEl) return;

        let name = "User";

        var check = await AuthManager.verify();
        if (!check.valid) {
          logout();
          return;
        }

        try {
          const doc = await db.collection("users").doc(user.uid).get();
          if (doc.exists) {
            const data = doc.data();
            name =
              data.fullname ||
              data.username ||
              user.email?.split("@")[0] ||
              "User";
          } else {
            name = user.displayName || user.email?.split("@")[0] || "User";
          }
        } catch (err) {
          name = user.displayName || user.email?.split("@")[0] || "User";
        }

        const formatted = name
          .toString()
          .split(/[.\-_\s]+/)
          .filter(Boolean)
          .map((part) => part.charAt(0).toUpperCase() + part.slice(1))
          .join(" ");

        nameEl.textContent = `Hi, ${formatted}`;
      }

      async function loadScanHistory() {
        try {
          const user = auth.currentUser;
          if (!user) return;

          const uid = user.uid;
          const scansRef = db.collection("users").doc(uid).collection("scans");
          const snapshot = await scansRef.orderBy("createdAt", "desc").get();

          const scanHistoryTable = document.querySelector(".table tbody");
          if (scanHistoryTable) {
            scanHistoryTable.innerHTML = "";

            if (snapshot.empty) {
              scanHistoryTable.innerHTML = `
                <tr>
                  <td colspan="5" class="text-center text-muted py-3">No scans yet. Start scanning!</td>
                </tr>
              return;
            }

            snapshot.forEach((doc) => {
              const scan = doc.data();
              const date = scan.createdAt
                ? new Date(
                    scan.createdAt.toDate
                      ? scan.createdAt.toDate()
                      : scan.createdAt
                  ).toLocaleString()
                : "N/A";

              let score = "N/A";
              let scoreClass = "secondary";

              if (scan.vulnerabilities) {
                const vulnKeys = Object.keys(scan.vulnerabilities);
                let totalScore = 0;
                let maxScore = 0;

                const severityWeights = {
                  low: 30,
                  medium: 70,
                  high: 100,
                };

                vulnKeys.forEach((key) => {
                  const vulnData = scan.vulnerabilities[key];
                  if (vulnData) {
                    const weight = severityWeights[vulnData.severity] || 70;
                    maxScore += weight;

                    if (
                      vulnData.status === "secure" ||
                      vulnData.status === "safe" ||
                      vulnData.status === "protected" ||
                      vulnData.status === "available" ||
                      vulnData.status === "not_found" ||
                      vulnData.status === "not_applicable"
                    ) {
                      totalScore += weight;
                    } else if (
                      vulnData.status === "vulnerable" ||
                      vulnData.status === "unsafe" ||
                      vulnData.status === "unprotected" ||
                      vulnData.status === "unavailable" ||
                      vulnData.status === "found" ||
                      vulnData.status === "error" ||
                      vulnData.status === "suspicious"
                    ) {
                    } else {
                      totalScore += Math.round(weight * 0.5);
                    }
                  }
                });

                const scorePercentage =
                  maxScore > 0 ? Math.round((totalScore / maxScore) * 100) : 0;
                score = scorePercentage + "%";

                if (scorePercentage >= 75) {
                  scoreClass = "success";
                } else if (scorePercentage >= 50) {
                  scoreClass = "warning";
                } else {
                  scoreClass = "danger";
                }
              }

              const row = `
                <tr>
                  <td>${escapeHtml(scan.url || "N/A")}</td>
                  <td>${date}</td>
                  <td><span class="badge bg-${
                    scan.status === "completed" ? "success" : "warning"
                  }">${escapeHtml(scan.status || "pending")}</span></td>
                  <td><span class="badge bg-${scoreClass}">${score}</span></td>
                  <td>
                    <button class="btn btn-sm btn-danger" onclick="deleteScanRecord('${
                      String(doc.id).replace(/'/g, "\\'")
                    }')">Delete</button>
                  </td>
                </tr>
              `;
              scanHistoryTable.innerHTML += row;
            });
          }
        } catch (error) {
        }
      }

      async function deleteScanRecord(scanId) {
        const confirmed = await VulnexalModal.confirm(
          "Are you sure you want to delete this scan? This action cannot be undone.",
          "Delete Scan"

        if (confirmed) {
          try {
            const user = auth.currentUser;
            if (!user) return;

            await db
              .collection("users")
              .doc(user.uid)
              .collection("scans")
              .doc(scanId)
              .delete();
            VulnexalModal.success(
              "Scan has been deleted successfully!",
              "Deleted",
              { autoClose: 2000 }
            loadScanHistory();
          } catch (error) {
            VulnexalModal.error(
              "Failed to delete scan. Please try again.",
              "Error"
          }
        }
      }

      function setupScanFunctionality() {
        const scanButton = document.getElementById("scan-website-btn");
        const urlInput = document.getElementById("scan-url-input");


        if (urlInput) {
          setupRealtimeValidation(urlInput, Validator.validateURL);
        }

        if (scanButton && urlInput) {
          scanButton.addEventListener("click", async function () {
            const url = urlInput.value.trim();

            if (!url) {
              VulnexalModal.warning(
                "Please enter a valid URL to scan",
                "URL Required"
              return;
            }

            const urlCheck = Validator.validateURL(url);
            if (!urlCheck.valid) {
              VulnexalModal.error(urlCheck.message, "Invalid URL");
              Validator.showFieldError(urlInput, urlCheck.message);
              return;
            }

            Validator.clearFieldValidation(urlInput);

            const overlay = document.getElementById("process-loading-overlay");
            if (overlay) overlay.classList.add("active");

            try {
              const results = await runScan(url);

              const vulnKeys = Object.keys(results.vulnerabilities);
              let totalScore = 0;
              let maxScore = 0;

              const severityWeights = {
                low: 30,
                medium: 70,
                high: 100,
              };

              vulnKeys.forEach((key) => {
                const vulnData = results.vulnerabilities[key];
                if (vulnData) {
                  const weight = severityWeights[vulnData.severity] || 70;
                  maxScore += weight;

                  if (
                    vulnData.status === "secure" ||
                    vulnData.status === "safe" ||
                    vulnData.status === "protected" ||
                    vulnData.status === "available" ||
                    vulnData.status === "not_found" ||
                    vulnData.status === "not_applicable"
                  ) {
                    totalScore += weight;
                  } else if (
                    vulnData.status === "vulnerable" ||
                    vulnData.status === "unsafe" ||
                    vulnData.status === "unprotected" ||
                    vulnData.status === "unavailable" ||
                    vulnData.status === "found" ||
                    vulnData.status === "error" ||
                    vulnData.status === "suspicious"
                  ) {
                  } else {
                    totalScore += Math.round(weight * 0.5);
                  }
                }
              });

              const scorePercentage =
                maxScore > 0 ? Math.round((totalScore / maxScore) * 100) : 0;

              const user = auth.currentUser;
              if (user) {
                await db
                  .collection("users")
                  .doc(user.uid)
                  .collection("scans")
                  .add({
                    url: url,
                    vulnerabilities: results.vulnerabilities,
                    status: results.status,
                    score: scorePercentage,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                  });
              }

              displayScanResults(results);

              await loadScanHistory();
            } catch (error) {
              VulnexalModal.error(
                "Failed to scan website: " +
                  error.message +
                  ". Please check the URL and try again.",
                "Scan Error"
            } finally {
              if (overlay) overlay.classList.remove("active");
            }
          });

          const handleScanEnterKey = (event) => {
            if (event.key === "Enter" || event.keyCode === 13) {
              event.preventDefault();
              scanButton.click();
            }
          };

          if (urlInput) {
            urlInput.addEventListener("keypress", handleScanEnterKey);
          }
        }
      }

      function displayScanResults(results) {

        const resultsSection = document.querySelector(".results-section");
        if (!resultsSection) {
          return;
        }

        const resultCards = resultsSection.querySelectorAll(".result-card");
        if (resultCards.length === 0) {
          return;
        }


        const vulnKeys = [
          "httpsValidation",
          "xssPatterns",
          "clickjackingProtection",
          "passwordFields",
          "availability",
          "suspiciousUrlPatterns",
        ];

        vulnKeys.forEach((key, index) => {
          if (resultCards[index]) {
            const card = resultCards[index];
            if (!results.vulnerabilities[key]) {
              card.style.opacity = "0.4";
              const badge = card.querySelector(".badge");
              const text = card.querySelector("p");

              if (badge) {
                badge.textContent = "NOT SCANNED";
                badge.className = "badge bg-secondary";
              }
              if (text) {
                text.textContent = "This check was not selected for scanning.";
              }
            } else {
              card.style.opacity = "1";
              const vulnData = results.vulnerabilities[key];
              const badge = card.querySelector(".badge");
              const text = card.querySelector("p");
              const icon = card.querySelector("i");

              if (badge) {
                badge.textContent = vulnData.severity.toUpperCase();
                badge.className = "badge rounded-pill";

                if (vulnData.severity === "low") {
                  badge.classList.add("bg-success");
                } else if (vulnData.severity === "medium") {
                  badge.classList.add("bg-warning", "text-dark");
                } else {
                  badge.classList.add("bg-danger");
                }
              }

              if (text) {
                text.textContent = vulnData.details;
              }

              if (icon) {
                icon.className = "bi";
                if (
                  vulnData.status === "secure" ||
                  vulnData.status === "safe" ||
                  vulnData.status === "protected" ||
                  vulnData.status === "available" ||
                  vulnData.status === "not_found"
                ) {
                  icon.classList.add("bi-shield-check", "text-success");
                } else if (
                  vulnData.status === "vulnerable" ||
                  vulnData.status === "unsafe" ||
                  vulnData.status === "unprotected" ||
                  vulnData.status === "found" ||
                  vulnData.status === "unavailable" ||
                  vulnData.status === "suspicious"
                ) {
                  icon.classList.add("bi-exclamation-triangle", "text-danger");
                } else {
                  icon.classList.add("bi-question-circle", "text-warning");
                }
              }

            }
          }
        });

        const scannedKeys = Object.keys(results.vulnerabilities);
        const totalChecks = scannedKeys.length;
        let totalScore = 0;
        let maxScore = 0;
        let vulnerableChecks = 0;
        let criticalIssues = 0;

        const severityWeights = {
          low: 30,
          medium: 70,
          high: 100,
        };

        scannedKeys.forEach((key) => {
          const vulnData = results.vulnerabilities[key];
          if (vulnData) {
            const weight = severityWeights[vulnData.severity] || 70;
            maxScore += weight;

            if (
              vulnData.status === "secure" ||
              vulnData.status === "safe" ||
              vulnData.status === "protected" ||
              vulnData.status === "available" ||
              vulnData.status === "not_found" ||
              vulnData.status === "not_applicable"
            ) {
              totalScore += weight;
            } else if (
              vulnData.status === "vulnerable" ||
              vulnData.status === "unsafe" ||
              vulnData.status === "unprotected" ||
              vulnData.status === "unavailable" ||
              vulnData.status === "found" ||
              vulnData.status === "error" ||
              vulnData.status === "suspicious"
            ) {
              vulnerableChecks++;
              if (vulnData.severity === "high") {
                criticalIssues++;
              }
            } else {
              totalScore += Math.round(weight * 0.5);
            }
          }
        });

        const scorePercentage =
          maxScore > 0 ? Math.round((totalScore / maxScore) * 100) : 0;

        let rating = "Poor";
        let ratingClass = "text-danger";
        if (scorePercentage >= 90) {
          rating = "Excellent";
          ratingClass = "text-success";
        } else if (scorePercentage >= 75) {
          rating = "Good";
          ratingClass = "text-success";
        } else if (scorePercentage >= 50) {
          rating = "Moderate";
          ratingClass = "text-warning";
        } else if (scorePercentage >= 25) {
          rating = "Poor";
          ratingClass = "text-danger";
        } else {
          rating = "Critical";
          ratingClass = "text-danger";
        }

        const scoreBadge = document.querySelector(".score-badge");
        const ratingElement = document.getElementById("security-rating");
        const summaryText = document.getElementById("security-summary");

        if (scoreBadge) {
          scoreBadge.textContent = scorePercentage + "%";
          scoreBadge.className = "score-badge";

          if (scorePercentage >= 75) {
            scoreBadge.style.background =
              "linear-gradient(135deg, #20c997, #17a085)";
          } else if (scorePercentage >= 50) {
            scoreBadge.style.background =
              "linear-gradient(135deg, #f39c12, #e67e22)";
          } else {
            scoreBadge.style.background =
              "linear-gradient(135deg, #e74c3c, #c0392b)";
          }
        }

        if (ratingElement) {
          ratingElement.textContent = rating;
          ratingElement.className = ratingClass;
        }

        if (summaryText) {
          if (vulnerableChecks === 0) {
            summaryText.textContent =
              "No vulnerabilities detected. Excellent security posture!";
            summaryText.className = "text-success small";
          } else {
            const issueText =
              vulnerableChecks === 1 ? "vulnerability" : "vulnerabilities";
            const criticalText =
              criticalIssues > 0 ? ` (${criticalIssues} critical)` : "";
            summaryText.textContent = `${vulnerableChecks} ${issueText} detected${criticalText}. Address issues for improved security.`;
            summaryText.className = "text-light small";
          }
        }

        const passedChecks = totalChecks - vulnerableChecks;

        resultsSection.style.display = "block";
      }

      window.addEventListener("load", function () {

        var checkAttempts = 0;
        var maxAttempts = 30;

        function checkAuth() {
          checkAttempts++;
          var currentUser = auth.currentUser;

          if (currentUser) {

            loadUserData(currentUser);
            loadScanHistory();
            setupScanFunctionality();

          } else if (checkAttempts < maxAttempts) {
            setTimeout(checkAuth, 200);
          } else {
            window.location.href = "index.html";
          }
        }

        auth.onAuthStateChanged(async (user) => {
          if (user) {
            showDashboard();

            await loadUserData(user);
            loadScanHistory();
            setupScanFunctionality();

          } else {
            setTimeout(function() {
              if (!auth.currentUser) {
                localStorage.removeItem("vulnexal_session");
                window.location.replace("index.html");
              }
            }, 2000);
          }

        });
      });

      async function runScan(url) {
        try {

          const httpsEnabled =
            document.getElementById("https-check")?.checked || false;
          const availabilityEnabled =
            document.getElementById("availability-check")?.checked || false;
          const clickjackEnabled =
            document.getElementById("clickjack-check")?.checked || false;
          const xssEnabled =
            document.getElementById("xss-check")?.checked || false;
          const passwordEnabled =
            document.getElementById("password-check")?.checked || false;
          const urlPatternsEnabled =
            document.getElementById("url-patterns-check")?.checked || false;

            https: httpsEnabled,
            availability: availabilityEnabled,
            clickjacking: clickjackEnabled,
            xss: xssEnabled,
            password: passwordEnabled,
            urlPatterns: urlPatternsEnabled,
          });

          const checksToRun = [];
          const checkMapping = [];

          if (httpsEnabled) {
            checksToRun.push(checkHttpsValidation(url));
            checkMapping.push("httpsValidation");
          }
          if (availabilityEnabled) {
            checksToRun.push(checkAvailability(url));
            checkMapping.push("availability");
          }
          if (clickjackEnabled) {
            checksToRun.push(checkClickjackingProtection(url));
            checkMapping.push("clickjackingProtection");
          }
          if (xssEnabled) {
            checksToRun.push(checkXssPatterns(url));
            checkMapping.push("xssPatterns");
          }
          if (passwordEnabled) {
            checksToRun.push(checkPasswordFields(url));
            checkMapping.push("passwordFields");
          }
          if (urlPatternsEnabled) {
            checksToRun.push(checkSuspiciousUrlPatterns(url));
            checkMapping.push("suspiciousUrlPatterns");
          }

          if (checksToRun.length === 0) {
            throw new Error("Please select at least one vulnerability check");
          }

          const results = {
            url: url,
            timestamp: Date.now(),
            status: "scanning",
            vulnerabilities: {},
            summary: {
              total: checksToRun.length,
              passed: 0,
              failed: 0,
              warnings: 0,
            },
          };


          const checks = await Promise.allSettled(checksToRun);

          const checkNames = {
            httpsValidation: "HTTPS Validation",
            availability: "Availability",
            clickjackingProtection: "Clickjacking Protection",
            xssPatterns: "XSS Patterns",
            passwordFields: "Password Fields",
            suspiciousUrlPatterns: "Suspicious URL Patterns",
          };

          checkMapping.forEach((key, index) => {
            results.vulnerabilities[key] =
              checks[index].status === "fulfilled"
                ? checks[index].value
                : {
                    status: "error",
                    details: checks[index].reason?.message || "Check failed",
                    severity: "high",
                  };

          });

          Object.keys(results.vulnerabilities).forEach((key) => {
            const check = results.vulnerabilities[key];

            if (
              check.status === "secure" ||
              check.status === "safe" ||
              check.status === "protected" ||
              check.status === "available"
            ) {
              results.summary.passed++;
            } else if (
              check.status === "vulnerable" ||
              check.status === "unsafe" ||
              check.status === "unprotected" ||
              check.status === "unavailable"
            ) {
              results.summary.failed++;
            } else {
              results.summary.warnings++;
            }
          });

          results.status = "completed";

          return results;
        } catch (error) {
          return {
            url: url,
            timestamp: Date.now(),
            status: "failed",
            vulnerabilities: {
              error: {
                status: "error",
                details: `Scan failed: ${error.message}`,
                severity: "high",
              },
            },
            summary: {
              total: 6,
              passed: 0,
              failed: 6,
              warnings: 0,
            },
          };
        }
      }

      async function checkHttpsValidation(url) {
        try {
          const urlObj = new URL(url);
          const isHttps = urlObj.protocol === "https:";
          return {
            status: isHttps ? "secure" : "vulnerable",
            details: isHttps
              ? "URL uses HTTPS encryption"
              : "URL does not use HTTPS - consider upgrading to HTTPS",
            severity: isHttps ? "low" : "medium",
          };
        } catch (error) {
          throw new Error(`HTTPS validation failed: ${error.message}`);
        }
      }

      async function checkAvailability(url) {
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 15000);

          let response;
          try {
            response = await fetch(url, {
              method: "HEAD",
              mode: "no-cors",
              signal: controller.signal,
            });
          } catch (e) {
            response = await fetch(url, {
              method: "HEAD",
              mode: "cors",
              signal: controller.signal,
            });
          }

          clearTimeout(timeoutId);

          return {
            status: "available",
            details: "Website is accessible and responding",
            severity: "low",
          };
        } catch (error) {
          if (error.name === "AbortError") {
            return {
              status: "unavailable",
              details:
                "Website timed out (took longer than 15 seconds to respond)",
              severity: "medium",
            };
          }
          if (error.message.includes("CORS")) {
            return {
              status: "available",
              details:
                "Website is accessible (CORS policy prevents detailed check)",
              severity: "low",
            };
          }
          return {
            status: "unavailable",
            details: `Website is not accessible: ${error.message}`,
            severity: "high",
          };
        }
      }

      async function checkClickjackingProtection(url) {
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10000);

          let response;
          let corsBlocked = false;

          try {
            response = await fetch(url, {
              method: "HEAD",
              mode: "cors",
              signal: controller.signal,
            });
          } catch (corsError) {
            corsBlocked = true;
          }

          clearTimeout(timeoutId);

          if (corsBlocked || !response) {
            return {
              status: "unknown",
              details:
                "Unable to verify clickjacking protection due to CORS restrictions (this does not indicate a vulnerability)",
              severity: "low",
            };
          }

          const headers = response.headers;
          const xFrameOptions = headers.get("x-frame-options");
          const csp = headers.get("content-security-policy");

          let protectionLevel = "none";
          let details = [];
          let severity = "high";

          if (xFrameOptions) {
            const xfoValue = xFrameOptions.toLowerCase();
            if (xfoValue.includes("deny") || xfoValue.includes("sameorigin")) {
              protectionLevel = "strong";
              details.push(`Protected with X-Frame-Options: ${xFrameOptions}`);
              severity = "low";
            } else {
              protectionLevel = "weak";
              details.push(
              severity = "medium";
            }
          }

          if (csp && csp.includes("frame-ancestors")) {
            protectionLevel =
              protectionLevel === "strong" ? "very_strong" : "moderate";
            severity = "low";
            details.push(
              "Protected with Content-Security-Policy frame-ancestors directive"
          }

          if (protectionLevel === "none") {
            details.push(
              "No clickjacking protection headers (X-Frame-Options or CSP frame-ancestors) found - site may be vulnerable to UI redressing attacks"
            return {
              status: "unprotected",
              details: details.join(". "),
              severity: "high",
            };
          }

          return {
            status: "protected",
            details: details.join(". "),
            severity: severity,
          };
        } catch (error) {
          if (error.name === "AbortError") {
            throw new Error(
              "Request timeout while checking clickjacking protection"
          }
          throw new Error(`Clickjacking check failed: ${error.message}`);
        }
      }

      async function checkXssPatterns(url) {
        try {
          const urlObj = new URL(url);
          const decodedUrl = decodeURIComponent(url);

          const queryString = urlObj.search + urlObj.hash;

          if (!queryString || queryString.length <= 1) {
            return {
              status: "safe",
              details:
                "No query parameters or URL fragments to check for XSS patterns",
              severity: "low",
            };
          }

          const dangerousPatterns = [
            { pattern: /<script[\s>]/i, name: "script tag" },
            { pattern: /javascript\s*:/i, name: "javascript protocol" },
            {
              pattern: /on(load|error|click|mouse|key)\s*=/i,
              name: "event handler",
            },
            { pattern: /<iframe/i, name: "iframe tag" },
            { pattern: /<embed/i, name: "embed tag" },
            { pattern: /<object/i, name: "object tag" },
            { pattern: /vbscript\s*:/i, name: "vbscript protocol" },
            { pattern: /data\s*:\s*text\/html/i, name: "data URL with HTML" },
            { pattern: /expression\s*\(/i, name: "CSS expression" },
            { pattern: /<svg[\s>].*on\w+/i, name: "SVG with event handler" },
          ];

          const foundIssues = [];
          for (const { pattern, name } of dangerousPatterns) {
            if (pattern.test(queryString)) {
              foundIssues.push(name);
            }
          }

          if (foundIssues.length > 0) {
            return {
              status: "vulnerable",
              details: `Dangerous XSS patterns detected: ${foundIssues.join(
                ", "
              )} - URL may be exploitable for cross-site scripting attacks`,
              severity: "high",
            };
          }

          return {
            status: "safe",
            details: "No dangerous XSS patterns detected in URL parameters",
            severity: "low",
          };
        } catch (error) {
          throw new Error(`XSS pattern check failed: ${error.message}`);
        }
      }

      async function checkPasswordFields(url) {
        try {
          const urlObj = new URL(url);
          const path = urlObj.pathname.toLowerCase();
          const isHttps = urlObj.protocol === "https:";

          if (
            path.includes(".js") ||
            path.includes(".css") ||
            path.includes(".png") ||
            path.includes(".jpg") ||
            path.includes(".gif") ||
            path.includes(".pdf") ||
            path.includes(".svg") ||
            path.includes(".ico") ||
            path.includes(".woff")
          ) {
            return {
              status: "not_applicable",
              details: "Not an HTML page - password field check not applicable",
              severity: "low",
            };
          }

          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10000);

          let response;
          let corsBlocked = false;

          try {
            response = await fetch(url, {
              method: "GET",
              mode: "cors",
              signal: controller.signal,
            });
          } catch (corsError) {
            corsBlocked = true;
          }

          clearTimeout(timeoutId);

          if (corsBlocked || !response) {
            return {
              status: "not_applicable",
              details:
                "Unable to check page content due to CORS restrictions (not a security issue)",
              severity: "low",
            };
          }

          if (!response.ok) {
            return {
              status: "not_applicable",
              details: `Cannot check page content (HTTP ${response.status})`,
              severity: "low",
            };
          }

          const contentType = response.headers.get("content-type") || "";
          if (!contentType.includes("text/html")) {
            return {
              status: "not_applicable",
              details: "Not an HTML page - password field check not applicable",
              severity: "low",
            };
          }

          const html = await response.text();
          const passwordInputs =
            html.match(/type\s*=\s*["']password["']/gi) || [];

          if (passwordInputs.length > 0) {
            if (!isHttps) {
              return {
                status: "vulnerable",
                details: `CRITICAL: ${passwordInputs.length} password field(s) found on HTTP (unencrypted) connection - passwords transmitted in plain text!`,
                severity: "high",
              };
            }
            return {
              status: "safe",
              details: `${passwordInputs.length} password field(s) found, protected by HTTPS encryption`,
              severity: "low",
            };
          }

          return {
            status: "safe",
            details: "No password input fields detected on this page",
            severity: "low",
          };
        } catch (error) {
          if (error.name === "AbortError") {
            throw new Error("Request timeout while checking password fields");
          }
          throw new Error(`Password field check failed: ${error.message}`);
        }
      }

      async function checkSuspiciousUrlPatterns(url) {
        try {
          const urlObj = new URL(url);
          const decodedUrl = decodeURIComponent(url);
          const domain = urlObj.hostname.toLowerCase();
          const queryAndHash = urlObj.search + urlObj.hash;
          const urlPath = urlObj.pathname;
          const paramCount = Array.from(urlObj.searchParams.keys()).length;

          let issues = [];
          let severity = "low";

          const dangerousPatterns = [
            { pattern: /\.\.[\/\\]/g, name: "directory traversal (../)" },
            { pattern: /%00/g, name: "null byte injection" },
            {
              pattern: /%252e%252e/gi,
              name: "double-encoded directory traversal",
            },
            {
              pattern: /[';].*union.*select/i,
              name: "SQL injection (UNION SELECT)",
            },
            { pattern: /[';].*or.*1\s*=\s*1/i, name: "SQL injection (OR 1=1)" },
            {
              pattern: /[';].*drop\s+table/i,
              name: "SQL injection (DROP TABLE)",
            },
            { pattern: /exec\s*\(/i, name: "command execution attempt" },
            { pattern: /\${.*}/g, name: "template injection" },
          ];

          for (const { pattern, name } of dangerousPatterns) {
            if (pattern.test(queryAndHash) || pattern.test(urlPath)) {
              issues.push(name);
              severity = "high";
            }
          }

          const phishingIndicators = [
            {
              pattern: /g[o0]{2}gle|go{3,}gle|g00gle/i,
              name: "Google typosquatting",
            },
            {
              pattern: /facebo{2,}k|facebok|faceb00k|faceebook/i,
              name: "Facebook typosquatting",
            },
            {
              pattern: /paypa[l1]|paypa11|paypai|paypal-|paypal\./i,
              name: "PayPal typosquatting",
            },
            {
              pattern: /amazo[n0]|amaz0n|amazon-|amazon\./i,
              name: "Amazon typosquatting",
            },
            {
              pattern: /micr[o0]s[o0]ft|micr0soft|microsoft-/i,
              name: "Microsoft typosquatting",
            },
            { pattern: /appl[e3]|app1e|apple-/i, name: "Apple typosquatting" },
            {
              pattern: /netfl[i1]x|netf1ix|netflix-/i,
              name: "Netflix typosquatting",
            },
            {
              pattern: /tw[i1]tter|twiter|twitter-/i,
              name: "Twitter typosquatting",
            },
            {
              pattern: /inst[a4]gr[a4]m|insta9ram|instagram-/i,
              name: "Instagram typosquatting",
            },
            {
              pattern: /wh[a4]ts[a4]pp|whatsap|whatsapp-/i,
              name: "WhatsApp typosquatting",
            },

            {
              pattern: /-login|login-|secure-|verify-|account-|update-/i,
              name: "suspicious login/verify in domain",
            },
            {
              pattern: /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/,
              name: "IP address instead of domain name",
            },
            { pattern: /@/, name: "phishing attempt with @ symbol" },
          ];

          for (const { pattern, name } of phishingIndicators) {
            if (pattern.test(domain)) {
              issues.push(name);
              severity = "high";
            }
          }

          const homographChars = /[Ð°-ÑÐ-Ð¯]|[Î±-Ï‰]|[\u0400-\u04FF]/;
          if (homographChars.test(domain)) {
            issues.push("homograph attack (lookalike characters)");
            severity = "high";
          }

          const suspiciousTLDs = [
            ".tk",
            ".ml",
            ".ga",
            ".cf",
            ".gq",
            ".xyz",
            ".top",
            ".work",
            ".date",
            ".review",
            ".country",
            ".stream",
            ".download",
            ".accountant",
            ".racing",
            ".cricket",
            ".science",
            ".party",
          ];
          const domainTLD = domain.substring(domain.lastIndexOf("."));
          if (suspiciousTLDs.includes(domainTLD)) {
            issues.push(
            severity = severity === "high" ? "high" : "medium";
          }

          const subdomainLevels = domain.split(".").length;
          if (subdomainLevels > 4) {
            issues.push(`excessive subdomain levels (${subdomainLevels})`);
            severity = severity === "high" ? "high" : "medium";
          }

          const suspiciousKeywords = [
            "verify",
            "secure",
            "update",
            "confirm",
            "account",
            "billing",
            "suspended",
            "unusual",
            "click",
            "urgent",
          ];
          const fullUrl = (urlPath + queryAndHash).toLowerCase();
          const foundKeywords = suspiciousKeywords.filter((keyword) =>
            fullUrl.includes(keyword)
          if (foundKeywords.length >= 3) {
            issues.push(
            severity = severity === "high" ? "high" : "medium";
          }

          if (paramCount > 30) {
            issues.push(`unusually high parameter count (${paramCount})`);
            severity = severity === "high" ? "high" : "medium";
          }

          if (
            queryAndHash &&
            (queryAndHash.match(/%3c/gi) || queryAndHash.match(/%3e/gi)) &&
            (queryAndHash.match(/%3cscript/gi) ||
              queryAndHash.match(/javascript/gi))
          ) {
            issues.push("encoded script injection attempt");
            severity = "high";
          }

          if (url.startsWith("data:")) {
            issues.push("data URI scheme (potential phishing technique)");
            severity = "high";
          }

          const urlShorteners = [
            "bit.ly",
            "tinyurl.com",
            "goo.gl",
            "t.co",
            "ow.ly",
            "is.gd",
            "buff.ly",
            "adf.ly",
            "short.link",
            "cutt.ly",
          ];
          if (urlShorteners.some((shortener) => domain.includes(shortener))) {
            issues.push("URL shortener detected (can hide destination)");
            severity = severity === "high" ? "high" : "medium";
          }

          if (issues.length > 0) {
            return {
              status: "suspicious",
              details: `âš ï¸ Suspicious patterns detected: ${issues.join(
                ", "
              )} - may indicate phishing or malicious intent`,
              severity: severity,
            };
          }

          return {
            status: "safe",
            details:
              "No suspicious, phishing, or malicious URL patterns detected",
            severity: "low",
          };
        } catch (error) {
          throw new Error(`URL pattern check failed: ${error.message}`);
        }
      }
    </script>
  </body>
</html>
